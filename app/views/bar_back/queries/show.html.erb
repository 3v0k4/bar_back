<%= link_to "home", root_path %>

<h2><%= @query.name %></h2>

<%= form_with model: @query do |form| %>
  <%= form.label :name %>
  <%= form.text_field :name %>
  <%= form.text_area :string, value: @query.string %>
  <%= form.submit "save & run" %>
<% end %>

<%= button_to "delete", query_path(id: @query.id), method: :delete, data: { confirm: "Are you sure?" } %>

<% if @error_messages.present? %>
  Errors:
  <ul>
    <% @error_messages.each do |error_message| %>
      <li><%= error_message %></li>
    <% end %>
  </ul>
<% end %>

<%= render "bar_back/queries/result", result: @result, allow_updates?: true %>

<%= link_to "csv", query_path(id: @query.id, format: "csv") %>

<% if @query.shared? %>
  <%= button_to "share", shared_query_path(id: @query.id), method: :put %>
<% else %>
  <%= button_to "unshare", shared_query_path(id: @query.id), method: :delete %>
  <%= link_to "public", shared_query_path(id: @query.id, uuid: @query.uuid), target: '_blank' %>
<% end %>
